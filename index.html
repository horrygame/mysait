<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYSTEM_BREACH.exe</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
            user-select: none;
        }
        
        body {
            background-color: #000;
            color: #0f0;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            position: fixed;
        }
        
        #matrix {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.3;
            pointer-events: none;
        }
        
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1;
            text-align: center;
        }
        
        h1 {
            color: #0f0;
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #0f0;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        h2 {
            color: #0f0;
            font-size: 2em;
            margin: 20px 0;
        }
        
        h3 {
            color: #0ff;
            font-size: 1.5em;
            margin: 10px 0;
        }
        
        .warning {
            color: #f00;
            font-size: 1.2em;
            animation: blink 1s infinite;
            font-weight: bold;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .btn {
            background-color: #002200;
            color: #0f0;
            border: 2px solid #0f0;
            padding: 15px 30px;
            font-size: 1.2em;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 5px;
        }
        
        .btn:hover {
            background-color: #0f0;
            color: #000;
            box-shadow: 0 0 15px #0f0;
        }
        
        .btn-red {
            background-color: #220000;
            border-color: #f00;
            color: #f00;
        }
        
        .btn-red:hover {
            background-color: #f00;
            color: #fff;
            box-shadow: 0 0 15px #f00;
        }
        
        .btn-blue {
            background-color: #000022;
            border-color: #00f;
            color: #00f;
        }
        
        .btn-blue:hover {
            background-color: #00f;
            color: #fff;
            box-shadow: 0 0 15px #00f;
        }
        
        .question-container {
            max-width: 900px;
            width: 100%;
            background-color: rgba(0, 30, 0, 0.8);
            border: 2px solid #0f0;
            border-radius: 10px;
            padding: 20px;
            margin: 20px;
            text-align: left;
        }
        
        .question-text {
            color: #fff;
            font-size: 1.3em;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .option {
            background-color: #001100;
            border: 1px solid #0a0;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 5px;
        }
        
        .option:hover {
            background-color: #003300;
            border-color: #0f0;
        }
        
        .option.selected {
            background-color: #0a0;
            color: #000;
            font-weight: bold;
        }
        
        .question-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .question-list {
            position: fixed;
            left: 20px;
            top: 100px;
            background-color: rgba(0, 20, 0, 0.9);
            border: 1px solid #0a0;
            padding: 15px;
            border-radius: 5px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .question-item {
            padding: 5px 10px;
            margin: 3px 0;
            cursor: pointer;
            border-radius: 3px;
        }
        
        .question-item.current {
            background-color: #0a0;
            color: #000;
            font-weight: bold;
        }
        
        .question-item.answered {
            color: #0f0;
        }
        
        .question-item.password {
            color: #0ff;
        }
        
        .password-input {
            background-color: #001100;
            color: #0f0;
            border: 2px solid #0a0;
            padding: 15px;
            font-size: 1.5em;
            width: 100%;
            text-align: center;
            letter-spacing: 5px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 300px;
            margin: 20px auto;
        }
        
        .keypad-btn {
            background-color: #002200;
            color: #0f0;
            border: 1px solid #0a0;
            padding: 20px;
            font-size: 1.5em;
            cursor: pointer;
            border-radius: 5px;
        }
        
        .keypad-btn:hover {
            background-color: #004400;
        }
        
        .lockdown-screen {
            background-color: #f00;
            animation: redPulse 0.5s infinite;
        }
        
        @keyframes redPulse {
            0%, 100% { background-color: #f00; }
            50% { background-color: #800; }
        }
        
        .lockdown-text {
            color: #fff;
            font-size: 3em;
            text-shadow: 0 0 10px #fff;
            margin-bottom: 30px;
        }
        
        .status-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 20, 0, 0.9);
            padding: 10px;
            text-align: center;
            border-top: 2px solid #0a0;
            z-index: 100;
        }
        
        .progress {
            color: #0ff;
            font-weight: bold;
        }
        
        .lockdown-warning {
            position: fixed;
            top: 10px;
            left: 10px;
            color: #f00;
            font-weight: bold;
            animation: blink 0.5s infinite;
        }
        
        .char {
            position: absolute;
            color: #0f0;
            font-size: 20px;
            font-weight: bold;
        }
        
        .congrats-text {
            color: #0f0;
            font-size: 2.5em;
            margin: 20px 0;
            text-shadow: 0 0 10px #0f0;
            animation: colorChange 3s infinite;
        }
        
        @keyframes colorChange {
            0% { color: #0f0; }
            33% { color: #0ff; }
            66% { color: #f0f; }
            100% { color: #0f0; }
        }
        
        #blocker {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 0, 0, 0.9);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        #closeAttempts {
            font-size: 4em;
            color: white;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        #attemptText {
            color: white;
            font-size: 2em;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Матричный эффект -->
    <div id="matrix"></div>
    
    <!-- Блокировщик закрытия -->
    <div id="blocker">
        <div id="closeAttempts">0</div>
        <div id="attemptText">ПОПЫТКА НЕСАНКЦИОНИРОВАННОГО ВЫХОДА<br>СИСТЕМА ЗАБЛОКИРОВАНА</div>
    </div>
    
    <!-- Экран приветствия -->
    <div id="welcomeScreen" class="screen">
        <h1>СИСТЕМА БЕЗОПАСНОСТИ</h1>
        <h2>ДОСТУП К ЦЕНТРАЛЬНОМУ СЕРВЕРУ</h2>
        
        <button class="btn" onclick="startGame()">АКТИВИРОВАТЬ СИСТЕМУ</button>
        
        <div style="margin-top: 50px;">
            <h3>Для получения доступа пройдите тест безопасности</h3>
            <p>18 вопросов | 4 темы | Полная блокировка системы</p>
            <p class="warning">ВНИМАНИЕ: ПОПЫТКИ ВЫХОДА БУДУТ ЗАБЛОКИРОВАНЫ</p>
        </div>
    </div>
    
    <!-- Экран вопросов -->
    <div id="questionScreen" class="screen" style="display: none;">
        <h2>ТЕСТ БЕЗОПАСНОСТИ</h2>
        <h3 id="questionNumber">Вопрос 1 из 18</h3>
        <div id="questionType" style="color: #ff0;">Тема: Системы счисления</div>
        
        <div class="question-container">
            <div id="questionText" class="question-text">
                Загрузка вопроса...
            </div>
            
            <div id="options" class="options">
                <!-- Варианты ответов будут здесь -->
            </div>
            
            <div class="question-nav">
                <button class="btn" onclick="prevQuestion()" id="prevBtn">← НАЗАД</button>
                <button class="btn" onclick="nextQuestion()" id="nextBtn">ДАЛЕЕ →</button>
            </div>
        </div>
        
        <!-- Список вопросов слева -->
        <div class="question-list" id="questionList">
            <div style="color: #0f0; margin-bottom: 10px; font-weight: bold;">ВОПРОСЫ:</div>
            <!-- Список будет заполнен JavaScript -->
        </div>
    </div>
    
    <!-- Экран пароля -->
    <div id="passwordScreen" class="screen" style="display: none;">
        <h2>ФИНАЛЬНЫЙ ШАГ</h2>
        <h3 style="color: #f00;">ПРИШЛО ВРЕМЯ УЙТИ ОТСЮДА</h3>
        <div style="color: #0f0; font-size: 1.2em; max-width: 800px; margin: 20px auto;">
            Введи пароль - это правильные ответы на все предыдущие вопросы по порядку
        </div>
        
        <div class="password-input" id="passwordDisplay">_______________</div>
        
        <div style="color: #ff0; margin-bottom: 20px;">
            Введите 17-значный пароль (номера правильных ответов на вопросы 1-17)
        </div>
        
        <div class="keypad" id="keypad">
            <!-- Клавиатура будет создана JavaScript -->
        </div>
        
        <div style="margin-top: 30px;">
            <button class="btn" onclick="checkPassword()">ПРОВЕРИТЬ ПАРОЛЬ</button>
            <button class="btn btn-blue" onclick="backToQuestions()">← К ВОПРОСАМ</button>
        </div>
    </div>
    
    <!-- Экран блокировки -->
    <div id="lockdownScreen" class="screen lockdown-screen" style="display: none;">
        <div class="lockdown-text">!</div>
        <div class="lockdown-text">ПОПЫТКА НЕСАНКЦИОНИРОВАННОГО ВЫХОДА</div>
        <div class="lockdown-text">СИСТЕМА ЗАБЛОКИРОВАНА</div>
        
        <div style="background-color: #000; padding: 20px; border-radius: 10px; margin: 30px; max-width: 400px;">
            <div class="password-input" id="lockdownDisplay">________</div>
            <div style="color: #fff; margin: 10px 0;" id="lockdownMessage">
                Введите пароль для разблокировки
            </div>
            
            <div class="keypad" id="lockdownKeypad">
                <!-- Клавиатура блокировки будет создана JavaScript -->
            </div>
            
            <div style="margin-top: 20px;">
                <button class="btn btn-red" onclick="checkLockdownPassword()">ВВОД</button>
            </div>
        </div>
        
        <div class="lockdown-warning" id="lockdownWarning">
            РЕЖИМ БЛОКИРОВКИ АКТИВИРОВАН
        </div>
    </div>
    
    <!-- Экран поздравления -->
    <div id="congratsScreen" class="screen" style="display: none;">
        <div class="congrats-text">ДОСТУП РАЗРЕШЕН</div>
        <div class="congrats-text">СИСТЕМНЫЙ ВЗЛОМ УСПЕШЕН</div>
        <div class="congrats-text">ПАРОЛЬ ПОДТВЕРЖДЕН</div>
        <div class="congrats-text">ВЫ ПОЛУЧАЕТЕ 5 ЗА УРОК</div>
        <div class="congrats-text">ОЦЕНКА: 5/5</div>
        
        <button class="btn btn-red" onclick="exitGame()" style="margin-top: 50px;">ВЫЙТИ ИЗ СИСТЕМЫ</button>
    </div>
    
    <!-- Статус бар -->
    <div class="status-bar" id="statusBar" style="display: none;">
        <div class="progress" id="progressText">Ответов: 0/17</div>
        <div style="color: #f00;">СИСТЕМА ЗАБЛОКИРОВАНА • ИСПОЛЬЗУЙТЕ МЫШЬ</div>
    </div>

    <script>
        // ==================== ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ====================
        let gameState = "welcome";
        let currentQuestion = 0;
        let answers = Array(17).fill(-1);
        let password = "";
        let lockdownPassword = "";
        let lockdownAttempts = 0;
        let closeAttempts = 0;
        let isLocked = true;
        
        // Матрица символов для эффекта
        const matrixChars = "01█▓▒░╬╣║╗╝╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌┐└┴┬├┼╞╟╚╔╩╦╠═╬░▒▓█";
        let matrixElements = [];
        
        // Правильный пароль (все ответы - вариант 4)
        const correctPassword = "44444444444444444";
        const unlockPassword = "12348765";
        
        // Вопросы для игры
        const questions = [
            // Системы счисления (6 вопросов)
            {
                text: "Переведите двоичное число 110101 в десятичную систему.",
                options: ["52", "54", "55", "53"],
                correct: 3,
                type: "Системы счисления"
            },
            {
                text: "В какой системе счисления выполняется равенство 12 + 5 = 20?",
                options: ["В двоичной", "В восьмеричной", "В шестнадцатеричной", "В семеричной"],
                correct: 3,
                type: "Системы счисления"
            },
            {
                text: "Сколько единиц в двоичной записи числа 87?",
                options: ["4", "5", "6", "7"],
                correct: 3,
                type: "Системы счисления"
            },
            {
                text: "Чему равна сумма чисел 1011₂ и 1101₂ в двоичной системе?",
                options: ["10100", "11000", "11100", "11001"],
                correct: 3,
                type: "Системы счисления"
            },
            {
                text: "Переведите десятичное число 95 в восьмеричную систему.",
                options: ["136", "137", "135", "137"],
                correct: 3,
                type: "Системы счисления"
            },
            {
                text: "Переведите шестнадцатеричное число A7 в десятичную систему.",
                options: ["166", "167", "168", "167"],
                correct: 3,
                type: "Системы счисления"
            },
            
            // Круги Эйлера (6 вопросов)
            {
                text: "В классе 35 человек. 20 занимаются спортом, 15 - музыкой, 8 - и тем и другим. Сколько человек ничем не занимаются?",
                options: ["6", "7", "8", "8"],
                correct: 3,
                type: "Круги Эйлера"
            },
            {
                text: "Из 40 туристов 25 знают английский, 20 - французский, 10 - оба языка. Сколько туристов не знают ни одного языка?",
                options: ["3", "4", "5", "5"],
                correct: 3,
                type: "Круги Эйлера"
            },
            {
                text: "В группе 50 студентов. 30 сдают математику, 25 - физику, 15 - оба экзамена. Сколько студентов не сдают эти экзамены?",
                options: ["8", "9", "10", "10"],
                correct: 3,
                type: "Круги Эйлера"
            },
            {
                text: "На предприятии 60 работников. 35 умеют работать на станке А, 40 - на станке Б, 25 - на обоих. Сколько не умеют работать ни на одном станке?",
                options: ["8", "9", "10", "10"],
                correct: 3,
                type: "Круги Эйлера"
            },
            {
                text: "В классе 28 учеников. Все посещают хотя бы один кружок: 15 - математический, 18 - биологический, 7 - оба. Сколько посещают только один кружок?",
                options: ["18", "19", "20", "19"],
                correct: 3,
                type: "Круги Эйлера"
            },
            {
                text: "В школе 100 учеников. 60 любят математику, 50 - физику, 30 - обе науки. Сколько учеников не любят ни математику, ни физику?",
                options: ["18", "19", "20", "20"],
                correct: 3,
                type: "Круги Эйлера"
            },
            
            // Таблицы истинности (5 вопросов)
            {
                text: "Для какого значения X истинно высказывание: (X > 3) И (X < 7)?",
                options: ["4", "5", "6", "5"],
                correct: 3,
                type: "Таблицы истинности"
            },
            {
                text: "Для какого значения X ложно высказывание: (X > 5) ИЛИ (X < 5)?",
                options: ["4", "5", "6", "5"],
                correct: 3,
                type: "Таблицы истинности"
            },
            {
                text: "Для какого значения X истинно высказывание: НЕ(X < 4) И (X > 2)?",
                options: ["3", "4", "5", "4"],
                correct: 3,
                type: "Таблицы истинности"
            },
            {
                text: "Для какого значения X ложно высказывание: (X ≠ 3) И (X ≠ 5) И (X > 2) И (X < 6)?",
                options: ["3", "4", "5", "4"],
                correct: 3,
                type: "Таблицы истинности"
            },
            {
                text: "Для какого значения X истинно высказывание: (X > 2) И (X < 6) И (X ≠ 4)?",
                options: ["3", "5", "6", "3"],
                correct: 3,
                type: "Таблицы истинности"
            },
            
            // История России
            {
                text: "В каком году произошло Крещение Руси?",
                options: ["987", "989", "998", "988"],
                correct: 3,
                type: "История России"
            }
        ];
        
        // ==================== МАТРИЧНЫЙ ЭФФЕКТ ====================
        function createMatrixEffect() {
            const matrixDiv = document.getElementById('matrix');
            for (let i = 0; i < 100; i++) {
                const char = document.createElement('div');
                char.className = 'char';
                char.textContent = matrixChars[Math.floor(Math.random() * matrixChars.length)];
                char.style.left = Math.random() * 100 + 'vw';
                char.style.top = Math.random() * 100 + 'vh';
                char.style.opacity = Math.random() * 0.5 + 0.3;
                matrixDiv.appendChild(char);
                matrixElements.push({
                    element: char,
                    speed: Math.random() * 2 + 1,
                    life: Math.random() * 10 + 5,
                    created: Date.now()
                });
            }
            
            // Обновление матричного эффекта
            setInterval(updateMatrix, 50);
        }
        
        function updateMatrix() {
            const now = Date.now();
            matrixElements.forEach(item => {
                let top = parseFloat(item.element.style.top);
                top += item.speed;
                
                if (top > 100 || now - item.created > item.life * 1000) {
                    top = -10;
                    item.created = now;
                    item.element.textContent = matrixChars[Math.floor(Math.random() * matrixChars.length)];
                    item.element.style.left = Math.random() * 100 + 'vw';
                }
                
                item.element.style.top = top + 'vh';
                
                // Плавное исчезновение
                const age = (now - item.created) / 1000;
                if (age > item.life * 0.7) {
                    item.element.style.opacity = 1 - (age - item.life * 0.7) / (item.life * 0.3);
                }
            });
        }
        
        // ==================== БЛОКИРОВКА ЗАКРЫТИЯ ====================
        function setupBlockers() {
            // Блокировка клавиш
            document.addEventListener('keydown', function(e) {
                if (gameState === "questions") {
                    // Разрешаем только навигацию в режиме вопросов
                    if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                        prevQuestion();
                    } else if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                        nextQuestion();
                    } else if (e.key >= '1' && e.key <= '4' && currentQuestion < 17) {
                        selectOption(parseInt(e.key) - 1);
                    } else if (e.key !== 'F5' && e.key !== 'F12') {
                        // Любая другая клавиша вызывает блокировку
                        if (!e.ctrlKey && !e.altKey) {
                            triggerLockdown();
                        }
                    }
                } else if (gameState !== "lockdown") {
                    // В других режимах блокируем все клавиши
                    if (e.key !== 'F5' && e.key !== 'F12') {
                        if (e.ctrlKey && e.key === 'r') return; // Разрешаем Ctrl+R
                        triggerLockdown();
                    }
                }
                
                // Блокировка Alt+F4, Win, Escape
                if (e.key === 'F4' && e.altKey || 
                    e.key === 'Escape' || 
                    e.key === 'Meta' || 
                    (e.altKey && e.key === 'Tab')) {
                    e.preventDefault();
                    triggerCloseAttempt();
                }
            });
            
            // Блокировка контекстного меню
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                triggerLockdown();
            });
            
            // Блокировка выхода
            window.addEventListener('beforeunload', function(e) {
                if (gameState !== "congrats" && isLocked) {
                    e.preventDefault();
                    e.returnValue = '';
                    triggerCloseAttempt();
                    return '';
                }
            });
            
            // Блокировка сочетаний клавиш
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && (e.key === 'w' || e.key === 'q' || e.key === 'n')) {
                    e.preventDefault();
                    triggerCloseAttempt();
                }
            });
        }
        
        function triggerCloseAttempt() {
            closeAttempts++;
            document.getElementById('closeAttempts').textContent = closeAttempts;
            document.getElementById('blocker').style.display = 'flex';
            
            // Автоматическое скрытие через 3 секунды
            setTimeout(() => {
                document.getElementById('blocker').style.display = 'none';
            }, 3000);
            
            // После 3 попыток - полная блокировка
            if (closeAttempts >= 3) {
                triggerLockdown();
            }
        }
        
        function triggerLockdown() {
            gameState = "lockdown";
            showScreen('lockdownScreen');
            document.getElementById('statusBar').style.display = 'none';
            isLocked = true;
        }
        
        // ==================== УПРАВЛЕНИЕ ИГРОЙ ====================
        function startGame() {
            gameState = "questions";
            currentQuestion = 0;
            showScreen('questionScreen');
            document.getElementById('statusBar').style.display = 'block';
            updateQuestion();
            updateQuestionList();
            updateProgress();
        }
        
        function showScreen(screenId) {
            // Скрыть все экраны
            document.querySelectorAll('.screen').forEach(screen => {
                screen.style.display = 'none';
            });
            
            // Показать нужный экран
            document.getElementById(screenId).style.display = 'flex';
            
            // Обновить статус бар
            if (screenId === 'questionScreen' || screenId === 'passwordScreen') {
                document.getElementById('statusBar').style.display = 'block';
            } else {
                document.getElementById('statusBar').style.display = 'none';
            }
        }
        
        function updateQuestion() {
            if (currentQuestion < 17) {
                const question = questions[currentQuestion];
                document.getElementById('questionNumber').textContent = `Вопрос ${currentQuestion + 1} из 18`;
                document.getElementById('questionType').textContent = `Тема: ${question.type}`;
                document.getElementById('questionText').textContent = question.text;
                
                // Обновить кнопки навигации
                document.getElementById('prevBtn').style.visibility = currentQuestion > 0 ? 'visible' : 'hidden';
                document.getElementById('nextBtn').textContent = currentQuestion < 16 ? 'ДАЛЕЕ →' : 'К ПАРОЛЮ →';
                
                // Очистить и заполнить варианты ответов
                const optionsDiv = document.getElementById('options');
                optionsDiv.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = `option ${answers[currentQuestion] === index ? 'selected' : ''}`;
                    optionDiv.textContent = `${index + 1}. ${option}`;
                    optionDiv.onclick = () => selectOption(index);
                    optionsDiv.appendChild(optionDiv);
                });
            } else {
                // 18-й вопрос - пароль
                showPasswordScreen();
            }
        }
        
        function selectOption(index) {
            answers[currentQuestion] = index;
            updateQuestion();
            updateQuestionList();
            updateProgress();
        }
        
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                updateQuestion();
                updateQuestionList();
            }
        }
        
        function nextQuestion() {
            if (currentQuestion < 17) {
                currentQuestion++;
                updateQuestion();
                updateQuestionList();
            }
        }
        
        function updateQuestionList() {
            const listDiv = document.getElementById('questionList');
            listDiv.innerHTML = '<div style="color: #0f0; margin-bottom: 10px; font-weight: bold;">ВОПРОСЫ:</div>';
            
            for (let i = 0; i < 18; i++) {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'question-item';
                
                if (i === currentQuestion) {
                    itemDiv.classList.add('current');
                }
                
                if (i < 17) {
                    if (answers[i] !== -1) {
                        itemDiv.classList.add('answered');
                        itemDiv.textContent = `${i + 1}. ${questions[i].type.substring(0, 8)} [${answers[i] + 1}]`;
                    } else {
                        itemDiv.textContent = `${i + 1}. ${questions[i].type.substring(0, 8)}`;
                    }
                } else {
                    itemDiv.classList.add('password');
                    itemDiv.textContent = `${i + 1}. ПАРОЛЬ`;
                }
                
                itemDiv.onclick = () => {
                    if (i < 17) {
                        currentQuestion = i;
                        updateQuestion();
                        updateQuestionList();
                    } else {
                        showPasswordScreen();
                    }
                };
                
                listDiv.appendChild(itemDiv);
            }
        }
        
        function updateProgress() {
            const answered = answers.filter(a => a !== -1).length;
            document.getElementById('progressText').textContent = `Ответов: ${answered}/17`;
        }
        
        // ==================== ЭКРАН ПАРОЛЯ ====================
        function showPasswordScreen() {
            gameState = "password";
            currentQuestion = 17;
            showScreen('passwordScreen');
            updatePasswordDisplay();
            createKeypad();
        }
        
        function updatePasswordDisplay() {
            let display = password;
            while (display.length < 17) {
                display += '_';
            }
            
            // Форматирование с пробелами
            let formatted = '';
            for (let i = 0; i < display.length; i++) {
                formatted += display[i];
                if ((i + 1) % 5 === 0 && i < 16) {
                    formatted += ' ';
                }
            }
            
            document.getElementById('passwordDisplay').textContent = formatted;
        }
        
        function createKeypad() {
            const keypadDiv = document.getElementById('keypad');
            keypadDiv.innerHTML = '';
            
            // Кнопки 1-9
            for (let i = 1; i <= 9; i++) {
                const btn = document.createElement('button');
                btn.className = 'keypad-btn';
                btn.textContent = i;
                btn.onclick = () => addToPassword(i.toString());
                keypadDiv.appendChild(btn);
            }
            
            // Кнопка 0
            const zeroBtn = document.createElement('button');
            zeroBtn.className = 'keypad-btn';
            zeroBtn.textContent = '0';
            zeroBtn.onclick = () => addToPassword('0');
            keypadDiv.appendChild(zeroBtn);
            
            // Кнопка удаления
            const delBtn = document.createElement('button');
            delBtn.className = 'keypad-btn btn-red';
            delBtn.textContent = '⌫';
            delBtn.onclick = () => {
                password = password.slice(0, -1);
                updatePasswordDisplay();
            };
            keypadDiv.appendChild(delBtn);
        }
        
        function addToPassword(digit) {
            if (password.length < 17) {
                password += digit;
                updatePasswordDisplay();
            }
        }
        
        function checkPassword() {
            if (password.length !== 17) {
                alert('Пароль должен содержать ровно 17 цифр!');
                return;
            }
            
            if (password === correctPassword) {
                gameState = "congrats";
                showScreen('congratsScreen');
                isLocked = false; // Разблокировать выход
            } else {
                alert('НЕВЕРНЫЙ ПАРОЛЬ!\nДоступ запрещён.\nПароль сброшен.');
                password = '';
                updatePasswordDisplay();
            }
        }
        
        function backToQuestions() {
            gameState = "questions";
            currentQuestion = 16;
            showScreen('questionScreen');
            updateQuestion();
            updateQuestionList();
        }
        
        // ==================== ЭКРАН БЛОКИРОВКИ ====================
        function setupLockdownKeypad() {
            const keypadDiv = document.getElementById('lockdownKeypad');
            keypadDiv.innerHTML = '';
            
            // Кнопки 1-9
            for (let i = 1; i <= 9; i++) {
                const btn = document.createElement('button');
                btn.className = 'keypad-btn';
                btn.style.backgroundColor = '#000';
                btn.style.color = '#fff';
                btn.style.borderColor = '#fff';
                btn.textContent = i;
                btn.onclick = () => addToLockdownPassword(i.toString());
                keypadDiv.appendChild(btn);
            }
            
            // Кнопка 0
            const zeroBtn = document.createElement('button');
            zeroBtn.className = 'keypad-btn';
            zeroBtn.style.backgroundColor = '#000';
            zeroBtn.style.color = '#fff';
            zeroBtn.style.borderColor = '#fff';
            zeroBtn.textContent = '0';
            zeroBtn.onclick = () => addToLockdownPassword('0');
            keypadDiv.appendChild(zeroBtn);
            
            // Кнопка удаления
            const delBtn = document.createElement('button');
            delBtn.className = 'keypad-btn';
            delBtn.style.backgroundColor = '#000';
            delBtn.style.color = '#fff';
            delBtn.style.borderColor = '#fff';
            delBtn.textContent = '⌫';
            delBtn.onclick = () => {
                lockdownPassword = lockdownPassword.slice(0, -1);
                updateLockdownDisplay();
            };
            keypadDiv.appendChild(delBtn);
        }
        
        function addToLockdownPassword(digit) {
            if (lockdownPassword.length < 8) {
                lockdownPassword += digit;
                updateLockdownDisplay();
            }
        }
        
        function updateLockdownDisplay() {
            let display = '';
            for (let i = 0; i < 8; i++) {
                display += i < lockdownPassword.length ? '*' : '_';
            }
            document.getElementById('lockdownDisplay').textContent = display;
            
            // Сообщение об ошибках
            if (lockdownAttempts > 0) {
                document.getElementById('lockdownMessage').innerHTML = 
                    `Неверный пароль. Попыток: ${lockdownAttempts}/3<br>Пароль: 12348765`;
            }
        }
        
        function checkLockdownPassword() {
            if (lockdownPassword === unlockPassword) {
                // Разблокировка
                lockdownPassword = '';
                lockdownAttempts = 0;
                isLocked = false;
                
                // Вернуться к предыдущему состоянию
                if (gameState === "lockdown") {
                    gameState = "questions";
                    showScreen('questionScreen');
                    document.getElementById('statusBar').style.display = 'block';
                    updateQuestion();
                    updateQuestionList();
                }
            } else {
                lockdownAttempts++;
                lockdownPassword = '';
                updateLockdownDisplay();
                
                if (lockdownAttempts >= 3) {
                    document.getElementById('lockdownMessage').innerHTML = 
                        'СИСТЕМА ОКОНЧАТЕЛЬНО ЗАБЛОКИРОВАНА<br>Перезагрузите страницу';
                    document.getElementById('lockdownKeypad').innerHTML = '';
                    document.querySelector('#lockdownScreen button').style.display = 'none';
                }
            }
        }
        
        // ==================== ЗАВЕРШЕНИЕ ИГРЫ ====================
        function exitGame() {
            if (gameState === "congrats") {
                // Показать прощальное сообщение
                alert('SYSTEM_BREACH завершён. Окно закроется через 3 секунды...');
                
                // Анимация закрытия
                document.body.style.opacity = '0';
                document.body.style.transition = 'opacity 3s';
                
                setTimeout(() => {
                    window.close();
                }, 3000);
            }
        }
        
        // ==================== ИНИЦИАЛИЗАЦИЯ ====================
        window.onload = function() {
            createMatrixEffect();
            setupBlockers();
            setupLockdownKeypad();
            
            // Информация для отладки
            console.log("======================================");
            console.log("ХАКЕРСКАЯ ИГРА: СИСТЕМНЫЙ ВЗЛОМ");
            console.log("======================================");
            console.log("ПРАВИЛЬНЫЙ ПАРОЛЬ: " + correctPassword);
            console.log("ПАРОЛЬ РАЗБЛОКИРОВКИ: " + unlockPassword);
            console.log("======================================");
            console.log("ПРЕДУПРЕЖДЕНИЕ: ПОПЫТКИ ВЫХОДА БУДУТ ЗАБЛОКИРОВАНЫ");
            console.log("======================================");
        };
    </script>
</body>
</html>
